<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title></title>
        <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/pure-min.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style>
/* #container { background: #1F8DD6; } */
#generator {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    margin: 0 auto;
}
#generator fieldset { padding: 1em; }
#generator input { text-align: center; }

@media (min-width: 48em) {
    body { font-size: 16px; }
    #generator { width: 66%; }
}
@media (min-width: 78em) {
    #generator { width: 50%; }
}
        </style>
    </head>
    <body>
        <div id="container">
            <form id="generator" class="pure-form" autocomplete="off">
                <fieldset class="pure-group">
                    <input id="master" type="password" placeholder="Master password" class="pure-u-1">
                    <input id="domain" type="text" placeholder="Domain" class="pure-u-1">
                    <input id="password" type="text" value="Generated password" readonly class="pure-u-1">
                </fieldset>
                <button type="submit" hidden>Go</button>
            </form>
        </div>
        <script src="../js-scrypt.git/browser/scrypt.js"></script>
        <script>
var scrypt = scrypt_module_factory();

function generateHandler(ev) {
    ev.preventDefault();

    var master = document.getElementById('master').value;
    var domain = document.getElementById('domain').value;

    var salt = scrypt.encode_utf8("c9463afb3a59bf5182debf31824cff4e");

    var generated = generate(master + '@' + domain, salt);

    var output = document.getElementById('password');
    output.value = generated;
}

function generate(master, domain) {
    var masterEnc = scrypt.encode_utf8(master);
    var domainEnc = scrypt.encode_utf8(domain);

    var N = 16384;
    var r = 8;
    var p = 1;
    var L = 16;

    var array = scrypt.crypto_scrypt(masterEnc, domainEnc, N, r, p, L);

    return scrypt.to_hex(array);
}

document.getElementById('generator').addEventListener('submit', generateHandler, false);
        </script>
    </body>
</html>
